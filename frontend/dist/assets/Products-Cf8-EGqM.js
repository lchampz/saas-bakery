import{v as S,o as e,B as i,w as L,h as u,x as U,y as O,q as h,I as q,z as Q,_ as H,C as J}from"./index-B2XkSwSp.js";import{M as T,S as R,u as K,n as M}from"./select-BAFG5Gfj.js";import{P as W}from"./skeleton-CKRTLbM3.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Y=S("chevron-left",X);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ee=S("chevron-right",Z);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],se=S("chevrons-left",te);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],ae=S("chevrons-right",re);function ne({open:s,onClose:r,onConfirm:x,title:j,message:o,confirmText:v="Confirmar",cancelText:p="Cancelar",variant:l="danger",loading:b=!1}){const f=()=>{x(),r()},N={danger:"bg-red-600 hover:bg-red-700 text-white",warning:"bg-yellow-600 hover:bg-yellow-700 text-white",info:"bg-blue-600 hover:bg-blue-700 text-white"};return e.jsx(T,{open:s,onClose:r,title:j,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:o}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(i,{variant:"ghost",onClick:r,disabled:b,children:p}),e.jsx(i,{onClick:f,disabled:b,className:N[l],children:b?"Processando...":v})]})]})})}function oe({pagination:s,onPageChange:r,onLimitChange:x,className:j}){const{page:o,limit:v,total:p,totalPages:l,hasNext:b,hasPrev:f}=s;if(l<=1)return null;const N=()=>{const a=[];if(l<=5)for(let d=1;d<=l;d++)a.push(d);else{a.push(1),o>3&&a.push("...");const d=Math.max(2,o-1),g=Math.min(l-1,o+1);for(let m=d;m<=g;m++)m!==1&&m!==l&&a.push(m);o<l-2&&a.push("..."),l>1&&a.push(l)}return a},$=(o-1)*v+1,c=Math.min(o*v,p);return e.jsxs("div",{className:L("flex flex-col sm:flex-row items-center justify-between gap-4 mt-6",j),children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",e.jsx("span",{className:"font-medium text-gray-900",children:$})," a"," ",e.jsx("span",{className:"font-medium text-gray-900",children:c})," de"," ",e.jsx("span",{className:"font-medium text-gray-900",children:p})," itens"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>r(1),disabled:!f,className:"px-2","aria-label":"Primeira p치gina",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>r(o-1),disabled:!f,className:"px-2","aria-label":"P치gina anterior",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center gap-1",children:N().map((a,y)=>{if(a==="...")return e.jsx("span",{className:"px-2 text-gray-400",children:"..."},`ellipsis-${y}`);const d=a,g=d===o;return e.jsx(i,{variant:g?"default":"outline",size:"sm",onClick:()=>r(d),className:L("min-w-[2.5rem]",g&&"bg-orange-500 hover:bg-orange-600 text-white border-orange-500"),"aria-label":`P치gina ${d}`,"aria-current":g?"page":void 0,children:d},d)})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>r(o+1),disabled:!b,className:"px-2","aria-label":"Pr칩xima p치gina",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>r(l),disabled:!b,className:"px-2","aria-label":"칔ltima p치gina",children:e.jsx(ae,{className:"w-4 h-4"})})]}),x&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Itens por p치gina:"}),e.jsxs(R,{value:v.toString(),onChange:a=>x(Number(a.target.value)),className:"w-20",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]})]})}function ie(s,r){const[x,j]=u.useState(s);return u.useEffect(()=>{const o=setTimeout(()=>{j(s)},r);return()=>{clearTimeout(o)}},[s,r]),x}const V=["mg","g","kg","ml","l","un"],le=Q({name:J().min(1,"Nome 칠 obrigat칩rio"),unit:H(V),quantity:M().nonnegative("Quantidade n칚o pode ser negativa").default(0),pricePerGram:M().nonnegative("Pre칞o por grama n칚o pode ser negativo").optional()});function ce(s,r){switch(r){case"kg":return s*1e3;case"g":return s;case"mg":return s/1e3;default:return s}}function de(s){const r=s/1e3;if(r>=1)return{grams:s,best:`${r.toFixed(1)} kg`};if(s>=1)return{grams:s,best:`${s.toFixed(1)} g`};const x=s*1e3;return{grams:s,best:`${x.toFixed(1)} mg`}}function me(){const{items:s,pagination:r,list:x,create:j,update:o,remove:v,loading:p,error:l}=K(),b=U(le),{register:f,handleSubmit:N,reset:$,formState:{errors:c}}=O({resolver:b,defaultValues:{name:"",unit:"g",quantity:0}}),[a,y]=u.useState(""),[d,g]=u.useState(!1),[m,E]=u.useState(null),[G,z]=u.useState(1),[_,I]=u.useState(10),k=ie(a,300);u.useEffect(()=>{x(G,_).catch(()=>h.error("Falha ao carregar produtos"))},[x,G,_]),u.useEffect(()=>{k&&z(1)},[k]);const A=async t=>{try{const n=t.unit==="un"?t.quantity:ce(t.quantity,t.unit);await j({name:t.name,quantity:n,unit:t.unit,pricePerGram:t.pricePerGram}),h.success("Produto adicionado com sucesso"),$({name:"",unit:"g",quantity:0}),g(!1)}catch{h.error("Erro ao adicionar produto")}},D=async t=>{try{await v(t),h.success("Produto removido com sucesso"),E(null)}catch{h.error("Erro ao remover produto")}},B=()=>{var n,w,P;const t=((n=c.name)==null?void 0:n.message)||((w=c.unit)==null?void 0:w.message)||((P=c.quantity)==null?void 0:P.message)||"Verifique os campos";h.error(String(t))};u.useEffect(()=>{l&&h.error(l)},[l]);const F=u.useMemo(()=>{if(!Array.isArray(s))return[];const t=k.trim().toLowerCase();return t?s.filter(n=>n.name.toLowerCase().includes(t)):s},[s,k]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Produtos"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie seu estoque de ingredientes"})]}),e.jsx(i,{variant:"secondary",onClick:()=>g(!0),className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:"+ Novo Produto"})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(q,{value:a,onChange:t=>y(t.target.value),placeholder:"Buscar produtos por nome...",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"})}),a&&e.jsx(i,{variant:"ghost",onClick:()=>y(""),className:"px-4 py-3 text-gray-600 hover:text-gray-800",children:"Limpar"})]})}),p&&e.jsx("div",{className:"grid lg:grid-cols-3 md:grid-cols-2 gap-6",children:Array.from({length:6}).map((t,n)=>e.jsx(W,{},n))}),e.jsx(T,{open:d,onClose:()=>g(!1),title:"Cadastrar Novo Produto",children:e.jsxs("form",{onSubmit:N(A,B),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Produto"}),e.jsx(q,{...f("name"),placeholder:"Ex.: Farinha de Trigo",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"}),c.name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.name.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantidade"}),e.jsx(q,{type:"number",step:"any",...f("quantity"),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"}),c.quantity&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.quantity.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unidade"}),e.jsx(R,{...f("unit"),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200",children:V.map(t=>e.jsx("option",{value:t,children:t},t))}),c.unit&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.unit.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pre칞o por Grama (R$)"}),e.jsx(q,{type:"number",step:"0.001",...f("pricePerGram"),placeholder:"Ex.: 0.025",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Pre칞o por grama para c치lculos de receita (opcional)"}),c.pricePerGram&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.pricePerGram.message})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(i,{type:"button",variant:"ghost",onClick:()=>g(!1),className:"px-6 py-2 text-gray-600 hover:text-gray-800",children:"Cancelar"}),e.jsx(i,{type:"submit",className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:"Salvar Produto"})]})]})}),!p&&e.jsx("div",{className:"grid lg:grid-cols-3 md:grid-cols-2 gap-6",children:F.map(t=>{const n=t.unit==="un",w=n?{grams:t.quantity,best:`${t.quantity.toFixed(0)} un`}:de(t.quantity),P=n?t.quantity<1:t.quantity<100;return e.jsxs("div",{className:"card card-hover p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-white text-lg ${P?"bg-gradient-to-r from-red-500 to-rose-600":"bg-gradient-to-r from-emerald-500 to-green-600"}`,children:"游닍"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Estoque atual"})]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${P?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:w.best})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Estoque base:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n?`${t.quantity.toFixed(0)} un`:`${w.grams.toFixed(0)}g`})]}),t.pricePerGram&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pre칞o/grama:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["R$ ",t.pricePerGram.toFixed(3)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:async()=>{try{const C=n?1:100;await o(t.id,{quantity:t.quantity+C}),h.success(`Estoque atualizado (+${C}${n?" un":"g"})`)}catch{h.error("Erro ao atualizar estoque")}},className:"flex-1 bg-green-50 hover:bg-green-100 text-green-700 px-3 py-2 rounded-lg text-sm font-medium",children:n?"+1 un":"+100g"}),e.jsx(i,{variant:"ghost",size:"sm",onClick:async()=>{try{const C=n?1:100;await o(t.id,{quantity:Math.max(0,t.quantity-C)}),h.success(`Estoque atualizado (-${C}${n?" un":"g"})`)}catch{h.error("Erro ao atualizar estoque")}},className:"flex-1 bg-orange-50 hover:bg-orange-100 text-orange-700 px-3 py-2 rounded-lg text-sm font-medium",children:n?"-1 un":"-100g"})]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>E({id:t.id,name:t.name}),className:"w-full text-red-600 hover:text-red-700 hover:bg-red-50 px-3 py-2 rounded-lg text-sm font-medium",children:"Remover Produto"})]})]},t.id)})}),!p&&F.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"游닍"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:a?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:a?"Tente ajustar sua busca":"Comece adicionando seus primeiros ingredientes"}),a?e.jsx(i,{variant:"ghost",onClick:()=>y(""),className:"px-6 py-3 text-gray-600 hover:text-gray-800",children:"Limpar busca"}):e.jsx(i,{onClick:()=>g(!0),className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:"Adicionar Primeiro Produto"})]}),r&&!a&&e.jsx(oe,{pagination:r,onPageChange:t=>{z(t),window.scrollTo({top:0,behavior:"smooth"})},onLimitChange:t=>{I(t),z(1)}}),e.jsx(ne,{open:!!m,onClose:()=>E(null),onConfirm:()=>m&&D(m.id),title:"Confirmar Exclus칚o",message:`Tem certeza que deseja remover o produto "${m==null?void 0:m.name}"?`,confirmText:"Remover",cancelText:"Cancelar",variant:"danger"})]})}const he=u.memo(me);export{he as default};
