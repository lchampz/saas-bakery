import{v as G,k as ne,l as F,h as p,q as m,o as e,I as $,B as v,L as se,x as ie,y as oe,T as X,z as Y,D as le,C as Z}from"./index-B2XkSwSp.js";import{u as J,S as ae,M as te,n as ce}from"./select-BAFG5Gfj.js";import{D as de,T as me}from"./trending-up-DaxF5Mio.js";import{P as xe}from"./package-7Psdy58s.js";import{R as ue}from"./skeleton-CKRTLbM3.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Q=G("calculator",he);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],pe=G("copy",ge);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ee=G("lock",fe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],je=G("plus",ye);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ve=G("save",be);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],W=G("sparkles",Ne);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ce=G("trash-2",we),ke=(h,f)=>({items:[],loading:!1,error:null,async list(){var x,d;h({loading:!0});try{const{data:N}=await F.get("/recipes");h({items:N,loading:!1})}catch(N){const i=N;h({error:((d=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:d.message)??"Failed to fetch recipes",loading:!1})}},async create(x){await F.post("/recipes",x),await f().list()},async update(x,d){await F.put(`/recipes/${x}`,d),await f().list()},async remove(x){await F.delete(`/recipes/${x}`),await f().list()},async prepare(x,d=1){await F.post(`/recipes/${x}/prepare?qty=${d}`),await f().list()},async generateWithAI(x){var d,N;h({loading:!0,error:null});try{const{data:i}=await F.post("/ai-recipes/generate",x);if(h({loading:!1}),i.success)return i.data;throw new Error("Falha ao gerar receita")}catch(i){const r=i;throw h({error:((N=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:N.message)??"Falha ao gerar receita",loading:!1}),r}},async scale(x,d){var N,i;h({loading:!0});try{const{data:r}=await F.post(`/recipes/${x}/scale`,{multiplier:d});return h({loading:!1}),r}catch(r){const g=r;throw h({error:((i=(N=g==null?void 0:g.response)==null?void 0:N.data)==null?void 0:i.message)??"Falha ao escalar receita",loading:!1}),g}}}),K=ne(ke);function Re({className:h=""}){const{items:f,list:x}=J(),{items:d,list:N}=K(),[i,r]=p.useState(""),[g,_]=p.useState(1),[k,q]=p.useState(60),[R,u]=p.useState([]),[n,P]=p.useState(null),[L,D]=p.useState(!1);p.useEffect(()=>{x(),N()},[x,N]),p.useEffect(()=>{n&&f.length>0&&V()},[f]);const V=()=>{if(!i&&R.length===0){m.error("Selecione uma receita ou adicione ingredientes");return}if(f.length===0){m.error("Nenhum produto dispon√≠vel. Adicione produtos primeiro.");return}D(!0);try{let s=[];if(i){const S=d&&d.length>0?d.find(a=>a.id===i):null;S&&S.ingredients&&(s=S.ingredients.map(a=>{const t=a.product||(f&&f.length>0?f==null?void 0:f.find(z=>z.id===a.productId):null),o=(t==null?void 0:t.pricePerGram)||0;return t&&!t.pricePerGram&&console.warn(`Produto "${t.name}" n√£o possui pre√ßo por grama definido`),{productId:a.productId,name:(t==null?void 0:t.name)||"Produto n√£o encontrado",amount:a.amount*g,unitPrice:o,totalCost:a.amount*g*o}}))}else s=R.map(S=>({...S,amount:S.amount*g,totalCost:S.amount*g*S.unitPrice}));const y=s.reduce((S,a)=>S+a.totalCost,0),b=y/g,A=b*(1+k/100),U=A-b;P({ingredients:s,totalCost:y,sellingPrice:A,profitMargin:k,profitAmount:U,portions:g,costPerPortion:b}),m.success("C√°lculo realizado com sucesso!")}catch{m.error("Erro ao calcular receita")}finally{D(!1)}},T=()=>{u([...R,{productId:"",name:"",amount:0,unitPrice:0,totalCost:0}])},c=s=>{u(R.filter((y,b)=>b!==s))},w=(s,y,b)=>{const A=[...R];A[s]={...A[s],[y]:b},(y==="amount"||y==="unitPrice")&&(A[s].totalCost=A[s].amount*A[s].unitPrice),u(A)},l=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),M=()=>{var s;if(n){const y=`
Receita: ${i&&d&&d.length>0?(s=d.find(b=>b.id===i))==null?void 0:s.name:"Receita Customizada"}
Por√ß√µes: ${n.portions}
Custo Total: ${l(n.totalCost)}
Pre√ßo de Venda: ${l(n.sellingPrice)}
Margem de Lucro: ${n.profitMargin}%
Lucro: ${l(n.profitAmount)}
      `.trim();navigator.clipboard.writeText(y),m.success("C√°lculo copiado para a √°rea de transfer√™ncia!")}};return e.jsxs("div",{className:`card p-6 ${h}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center text-white shadow-lg",children:e.jsx(Q,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Calculadora de Receitas"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Calcule custos, pre√ßos e margens de lucro das suas receitas"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Receita Base (opcional)"}),e.jsxs(ae,{value:i,onChange:s=>r(s.target.value),className:"w-full",children:[e.jsx("option",{value:"",children:"Receita Customizada"}),d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N√∫mero de Por√ß√µes"}),e.jsx($,{type:"number",value:g,onChange:s=>_(Number(s.target.value)),min:"1",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margem de Lucro (%)"}),e.jsx($,{type:"number",value:k,onChange:s=>q(Number(s.target.value)),min:"0",max:"500",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"})]})]}),!i&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ingredientes Customizados"}),e.jsxs(v,{onClick:T,size:"sm",variant:"outline",children:[e.jsx(je,{className:"w-4 h-4 mr-1"}),"Adicionar"]})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-auto",children:R.map((s,y)=>e.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[e.jsx($,{placeholder:"Nome do ingrediente",value:s.name,onChange:b=>w(y,"name",b.target.value)}),e.jsx($,{type:"number",placeholder:"Quantidade",value:s.amount,onChange:b=>w(y,"amount",Number(b.target.value)),min:"0",step:"0.1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx($,{type:"number",placeholder:"Pre√ßo por grama (R$)",value:s.unitPrice,onChange:b=>w(y,"unitPrice",Number(b.target.value)),min:"0",step:"0.001"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:l(s.totalCost)}),e.jsx(v,{onClick:()=>c(y),size:"sm",variant:"outline",className:"p-1",children:e.jsx(Ce,{className:"w-3 h-3"})})]})]})]},y))})]}),e.jsx(v,{onClick:V,disabled:L,className:"w-full bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:L?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm"}),"Calculando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Calcular Receita"]})})]}),e.jsx("div",{className:"space-y-4",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-emerald-500 to-green-600 rounded-lg flex items-center justify-center text-white",children:e.jsx(de,{className:"w-4 h-4"})}),"Resumo Financeiro"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Custo Total:"}),e.jsx("span",{className:"font-medium",children:l(n.totalCost)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Custo por Por√ß√£o:"}),e.jsx("span",{className:"font-medium",children:l(n.costPerPortion)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Pre√ßo de Venda:"}),e.jsx("span",{className:"font-medium text-green-600",children:l(n.sellingPrice)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Margem de Lucro:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[n.profitMargin,"%"]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Lucro por Por√ß√£o:"}),e.jsx("span",{className:"font-bold text-green-600",children:l(n.profitAmount)})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white",children:e.jsx(xe,{className:"w-4 h-4"})}),"Detalhamento de Ingredientes"]}),e.jsx("div",{className:"space-y-3 max-h-48 overflow-auto",children:n.ingredients.map((s,y)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("span",{className:"text-sm font-bold text-green-600",children:l(s.totalCost)})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsxs("span",{children:[s.amount,"g √ó ",s.unitPrice>0?`${l(s.unitPrice)}/g`:"Pre√ßo n√£o definido"]}),e.jsxs("span",{className:s.unitPrice>0?"":"text-red-500",children:["= ",s.unitPrice>0?l(s.amount*s.unitPrice):"R$ 0,00"]})]})]},y))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{onClick:M,variant:"outline",className:"flex-1 bg-gray-50 hover:bg-gray-100 text-gray-700 px-4 py-3 rounded-xl border border-gray-200 hover:border-gray-300 transition-all duration-200",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Copiar C√°lculo"]}),e.jsxs(v,{variant:"outline",className:"flex-1 bg-orange-50 hover:bg-orange-100 text-orange-700 px-4 py-3 rounded-xl border border-orange-200 hover:border-orange-300 transition-all duration-200",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Salvar Receita"]})]})]}):e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Q,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Configure e calcule"}),e.jsx("p",{className:"text-gray-600",children:"Selecione uma receita ou adicione ingredientes customizados para ver os c√°lculos aqui."})]})})]}),e.jsxs("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Dicas para Precifica√ß√£o"]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Margem de 50-70% √© comum para confeitaria"}),e.jsx("li",{children:"‚Ä¢ Considere custos indiretos (energia, √°gua, embalagem)"}),e.jsx("li",{children:"‚Ä¢ Pesquise pre√ßos da concorr√™ncia"}),e.jsx("li",{children:"‚Ä¢ Ajuste pre√ßos conforme sazonalidade"})]})]})]})}function Pe({open:h,onClose:f,onRecipeGenerated:x}){const{generateWithAI:d,loading:N}=K(),{items:i}=J(),[r,g]=p.useState(""),[_,k]=p.useState(8),[q,R]=p.useState(""),[u,n]=p.useState(null),[P,L]=p.useState(!1),D=async()=>{if(!r.trim()){m.error("Por favor, descreva a receita que deseja criar");return}L(!0);try{const c=q.split(",").map(l=>l.trim()).filter(l=>l.length>0),w=await d({description:r.trim(),servingSize:_,dietaryRestrictions:c});n(w),m.success("Receita gerada com sucesso!")}catch{m.error("Erro ao gerar receita. Tente novamente.")}finally{L(!1)}},V=()=>{if(!u)return;const c=u.ingredients.map(w=>{const l=Array.isArray(i)?i.find(M=>M.name.toLowerCase()===w.productName.toLowerCase()):null;return l?{productId:l.id,amount:w.amount}:null}).filter(w=>w!==null);if(c.length===0){m.error("Nenhum produto correspondente encontrado. Verifique os produtos cadastrados.");return}x({name:u.name,ingredients:c,instructions:u.instructions,servingSize:u.servingSize}),g(""),k(8),R(""),n(null),f()},T=()=>{g(""),k(8),R(""),n(null),f()};return e.jsx(te,{open:h,onClose:T,title:"Gerar Receita com IA",className:"max-w-3xl",children:e.jsx("div",{className:"space-y-4",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl",children:"‚ú®"}),e.jsx("h3",{className:"font-semibold text-green-900 text-sm",children:"Receita Gerada com Sucesso!"})]}),e.jsx("p",{className:"text-xs text-green-700",children:'Revise os detalhes abaixo e clique em "Usar Receita" para adicion√°-la ao sistema.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Nome da Receita"}),e.jsx($,{value:u.name,onChange:c=>n({...u,name:c.target.value}),className:"w-full text-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Ingredientes"}),e.jsx("div",{className:"space-y-1.5 max-h-32 overflow-y-auto p-2 bg-gray-50 rounded-lg border border-gray-200",children:u.ingredients.map((c,w)=>{const l=Array.isArray(i)?i.find(M=>M.name.toLowerCase()===c.productName.toLowerCase()):null;return e.jsxs("div",{className:"flex items-center justify-between p-1.5 bg-white rounded text-sm",children:[e.jsxs("span",{className:"text-gray-900 text-sm",children:[c.productName," - ",c.amount," ",c.unit||"g"]}),l?e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"‚úì Encontrado"}):e.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"‚ö† N√£o encontrado"})]},w)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Instru√ß√µes"}),e.jsx("textarea",{value:u.instructions,onChange:c=>n({...u,instructions:c.target.value}),className:"w-full px-3 py-2 text-sm text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",rows:4})]}),e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Custo Estimado"}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:["R$ ",u.estimatedCost.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Por√ß√µes"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:u.servingSize})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Custo por Por√ß√£o"}),e.jsxs("p",{className:"text-base font-semibold text-gray-900",children:["R$ ",(u.estimatedCost/u.servingSize).toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-200",children:[e.jsx(v,{type:"button",variant:"ghost",onClick:()=>n(null),className:"text-gray-700 hover:text-gray-900",children:"Gerar Outra"}),e.jsx(v,{type:"button",onClick:V,className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white",children:"Usar Receita"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2.5 p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[e.jsx(W,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-purple-900 text-sm",children:"Gerador de Receitas com IA"}),e.jsx("p",{className:"text-xs text-purple-700",children:"Descreva a receita que deseja criar e nossa IA ir√° gerar uma receita completa com ingredientes e instru√ß√µes."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1.5",children:"Descri√ß√£o da Receita *"}),e.jsx($,{value:r,onChange:c=>g(c.target.value),placeholder:"Ex.: Bolo de chocolate com cobertura de ganache e morangos",className:"w-full text-gray-900",disabled:P}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Seja espec√≠fico sobre o tipo de receita, sabores e caracter√≠sticas desejadas"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1.5",children:"Por√ß√µes"}),e.jsx($,{type:"number",min:"1",value:_,onChange:c=>k(parseInt(c.target.value)||8),className:"w-full text-gray-900",disabled:P})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1.5",children:"Restri√ß√µes Alimentares (opcional)"}),e.jsx($,{value:q,onChange:c=>R(c.target.value),placeholder:"Ex.: sem gl√∫ten, vegano, sem lactose",className:"w-full text-gray-900",disabled:P}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separe m√∫ltiplas restri√ß√µes por v√≠rgula"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t border-gray-200",children:[e.jsx(v,{type:"button",variant:"ghost",onClick:T,disabled:P,children:"Cancelar"}),e.jsx(v,{type:"button",onClick:D,disabled:P||!r.trim(),className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white",children:P?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm",className:"mr-2"}),"Gerando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Gerar Receita"]})})]})]})})})}const Se=Y({name:Z().min(1,"Nome √© obrigat√≥rio").max(100,"Nome muito longo"),ingredients:le(Y({productId:Z().min(1,"Produto √© obrigat√≥rio"),amount:ce().positive("Quantidade deve ser positiva")})).min(1,"Receita deve ter pelo menos um ingrediente")});function Ee(){const{items:h,list:f,create:x,remove:d,prepare:N,loading:i}=K(),{items:r,list:g}=J(),[_,k]=p.useState(!1),[q,R]=p.useState(!1),[u,n]=p.useState([]),[P,L]=p.useState(!0),[D,V]=p.useState({}),T=ie(Se),{register:c,handleSubmit:w,reset:l,formState:{errors:M}}=oe({resolver:T,defaultValues:{name:"",ingredients:[{productId:"",amount:0}]}});p.useEffect(()=>{(async()=>{try{L(!0),await g(),await f()}catch{m.error("Falha ao carregar dados")}finally{L(!1)}})()},[f,g]),p.useEffect(()=>{if(!P&&Array.isArray(h)&&Array.isArray(r)){const a={};h.forEach(t=>{var z;const o=[];(z=t.ingredients)==null||z.forEach(C=>{const j=C.product||r.find(I=>I.id===C.productId);if(j){const I=C.amount;j.quantity<I&&o.push({productName:j.name,needed:I,available:j.quantity})}}),a[t.id]={canPrepare:o.length===0,insufficientItems:o}}),V(a)}},[h,r,P]);const s=()=>{if(r.length===0){m.error("Nenhum produto dispon√≠vel. Adicione produtos primeiro.");return}n(a=>{var t;return[...a,{productId:Array.isArray(r)?((t=r[0])==null?void 0:t.id)??"":"",amount:0}]})},y=a=>n(t=>t.filter((o,z)=>z!==a)),b=(a,t,o)=>{n(z=>z.map((C,j)=>j===a?{...C,[t]:t==="amount"?Number(o):o}:C))},A=async a=>{try{await x({name:a.name,ingredients:u.filter(t=>t.productId)}),m.success("Receita criada"),l(),n([]),k(!1)}catch{m.error("Erro ao criar receita")}},U=async a=>{try{await x(a),m.success("Receita criada com sucesso!"),l(),n([])}catch{m.error("Erro ao criar receita")}},S=()=>{m.error("Verifique os dados da receita")};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Receitas"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie suas receitas e ingredientes"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{onClick:()=>R(!0),className:"bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Gerar com IA"]}),e.jsx(v,{onClick:()=>{var a;if(r.length===0){m.error("Nenhum produto dispon√≠vel. Adicione produtos primeiro.");return}l(),n([{productId:((a=r[0])==null?void 0:a.id)??"",amount:0}]),k(!0)},className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:"+ Nova Receita"})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx(Re,{})}),e.jsx(Pe,{open:q,onClose:()=>R(!1),onRecipeGenerated:U}),e.jsx(te,{open:_,onClose:()=>k(!1),title:"Criar Nova Receita",children:e.jsxs("form",{onSubmit:w(A,S),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Receita"}),e.jsx($,{...c("name"),placeholder:"Ex.: Bolo de Chocolate",className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-200"}),M.name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:M.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Ingredientes"}),e.jsx("div",{className:"space-y-3",children:u.map((a,t)=>e.jsxs("div",{className:"flex gap-3 items-center p-3 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(ae,{value:a.productId,onChange:o=>b(t,"productId",o.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione um produto"}),Array.isArray(r)&&r.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})}),e.jsx("div",{className:"w-24",children:e.jsx($,{type:"number",step:"any",value:a.amount,onChange:o=>b(t,"amount",o.target.value),placeholder:"Qtd (g)",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-transparent"})}),e.jsx(v,{type:"button",variant:"ghost",onClick:()=>y(t),className:"w-10 h-10 rounded-lg hover:bg-red-100 hover:text-red-600",children:"√ó"})]},t))}),e.jsx(v,{type:"button",variant:"secondary",onClick:s,className:"mt-3 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg",children:"+ Adicionar Ingrediente"}),M.ingredients&&e.jsx("p",{className:"text-red-600 text-sm mt-2",children:M.ingredients.message})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(v,{type:"button",variant:"ghost",onClick:()=>k(!1),className:"px-6 py-2 text-gray-600 hover:text-gray-800",children:"Cancelar"}),e.jsx(v,{type:"submit",disabled:i,className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-2 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:i?"Salvando...":"Salvar Receita"})]})]})}),P?e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:Array.from({length:4}).map((a,t)=>e.jsx(ue,{},t))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:Array.isArray(h)&&h.map(a=>{const t=D[a.id],o=(t==null?void 0:t.canPrepare)??!0,z=(t==null?void 0:t.insufficientItems)||[];return e.jsxs("div",{className:`card p-6 ${o?"card-hover":"opacity-75 border-2 border-amber-200 bg-amber-50/30"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-white text-lg ${o?"bg-gradient-to-r from-purple-500 to-pink-600":"bg-amber-500"}`,children:o?"üç∞":e.jsx(ee,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.ingredients.length," ingredientes"]}),!o&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-xs text-amber-700 bg-amber-100 px-2 py-1 rounded",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsx("span",{children:"Estoque insuficiente"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:"secondary",onClick:async()=>{var C,j,I,O;try{await N(a.id,1),m.success("Receita preparada com sucesso!"),await g()}catch(E){const B=((j=(C=E==null?void 0:E.response)==null?void 0:C.data)==null?void 0:j.insufficientItems)||[];if(B.length>0){const re=B.map(H=>`${H.productName} (necess√°rio: ${H.needed}g, dispon√≠vel: ${H.available}g)`).join(", ");m.error(`Estoque insuficiente: ${re}`)}else m.error(((O=(I=E==null?void 0:E.response)==null?void 0:I.data)==null?void 0:O.message)||"Erro ao preparar receita")}},disabled:!o||i,className:`px-3 py-1 rounded-lg text-sm ${o?"bg-green-100 hover:bg-green-200 text-green-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:o?"Preparar":e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-3 h-3 mr-1 inline"}),"Bloqueada"]})}),e.jsx(v,{variant:"ghost",onClick:async()=>{try{await d(a.id),m.success("Receita removida")}catch{m.error("Erro ao remover receita")}},className:"text-red-600 hover:text-red-700 hover:bg-red-50 px-3 py-1 rounded-lg text-sm",children:"Remover"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Ingredientes:"}),e.jsx("ul",{className:"space-y-1",children:a.ingredients.map(C=>{const j=C.product||(Array.isArray(r)?r.find(B=>B.id===C.productId):null),I=z.some(B=>B.productName===(j==null?void 0:j.name)),O=(j==null?void 0:j.quantity)||0,E=C.amount;return e.jsxs("li",{className:`flex justify-between items-center text-sm p-2 rounded-lg ${I?"bg-red-50 border border-red-200":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:`text-gray-900 ${I?"font-medium":""}`,children:(j==null?void 0:j.name)||"Produto n√£o encontrado"}),I&&e.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),O,"g dispon√≠vel (necess√°rio: ",E,"g)"]})]}),e.jsxs("span",{className:`font-medium ${I?"text-red-600":"text-gray-600"}`,children:[E,"g"]})]},C.id)})})]})]},a.id)})}),Array.isArray(h)&&h.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl",children:"üç∞"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma receita cadastrada"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece criando sua primeira receita"}),e.jsx(v,{onClick:()=>{var a;if(r.length===0){m.error("Nenhum produto dispon√≠vel. Adicione produtos primeiro.");return}l(),n([{productId:((a=r[0])==null?void 0:a.id)??"",amount:0}]),k(!0)},className:"bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700 text-white font-semibold px-6 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-[1.02]",children:"Criar Primeira Receita"})]})]})]})}export{Ee as default};
